#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

#include "make_const_nonconst.h"
#include "levels/bitdw/header.h"

const LevelScript level_bitdw_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _bitdw_segment_7SegmentRomStart, _bitdw_segment_7SegmentRomEnd), 
	LOAD_MIO0(0x0A, _bidw_skybox_mio0SegmentRomStart, _bidw_skybox_mio0SegmentRomEnd), 
	LOAD_MIO0_TEXTURE(0x09, _sky_mio0SegmentRomStart, _sky_mio0SegmentRomEnd), 
	LOAD_MIO0(0x05, _group2_mio0SegmentRomStart, _group2_mio0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group2_geoSegmentRomStart, _group2_geoSegmentRomEnd), 
	LOAD_MIO0(0x06, _group17_mio0SegmentRomStart, _group17_mio0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group17_geoSegmentRomStart, _group17_geoSegmentRomEnd), 
	LOAD_MIO0(0x08, _common0_mio0SegmentRomStart, _common0_mio0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_3), 
	JUMP_LINK(script_func_global_18), 
	JUMP_LINK(script_func_global_1), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_03, geo_bitdw_0003C0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_04, geo_bitdw_0003D8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_05, geo_bitdw_0003F0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_06, geo_bitdw_000408), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_07, geo_bitdw_000420), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_08, geo_bitdw_000438), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_09, geo_bitdw_000450), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0A, geo_bitdw_000468), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0B, geo_bitdw_000480), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0C, geo_bitdw_000498), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0D, geo_bitdw_0004B0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0E, geo_bitdw_0004C8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0F, geo_bitdw_0004E0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_10, geo_bitdw_0004F8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_11, geo_bitdw_000510), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_SQUARE_PLATFORM, geo_bitdw_000558), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_SEESAW_PLATFORM, geo_bitdw_000540), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_SLIDING_PLATFORM, geo_bitdw_000528), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_FERRIS_WHEEL_AXLE, geo_bitdw_000570), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_BLUE_PLATFORM, geo_bitdw_000588), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME4, geo_bitdw_0005A0), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME3, geo_bitdw_0005B8), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME2, geo_bitdw_0005D0), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME1, geo_bitdw_0005E8), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE, geo_bitdw_000600), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_WARP_PIPE, warp_pipe_geo), 
	LOAD_MODEL_FROM_GEO(248, warp_pipe_geo), 

	AREA(1, bitdw_area_1),
		WARP_NODE(0x11, LEVEL_BITDW, 0x01, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x12, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(241, LEVEL_CASTLE, 0x02, 0x5C, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 0x02, 0x5B, WARP_NO_CHECKPOINT),
		WARP_NODE(0x21, LEVEL_BITDW, 0x02, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x1C, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x1B, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(223, -3833, -471, 7255, 0, 0, 0, 0x0, bhvChuckya),
		OBJECT(86, 2694, -471, 3580, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(206, -1191, -114, 3201, 0, 0, 0, 0x0, bhvSnufit),
		OBJECT(0, 4152, 322, 3183, 0, 90, 0, 0x1C0000, bhvAirborneDeathWarp),
		OBJECT(248, 4294, -111, 2278, 0, -13, 0, 0x210000, bhvWarpPipe),
		OBJECT(0, -6648, 3, 7034, 0, 90, 0, 0x120000, bhvAirborneWarp),
		TERRAIN(bitdw_area_1_collision),
		MACRO_OBJECTS(bitdw_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x2C),
		TERRAIN_TYPE(TERRAIN_GRASS),
	END_AREA(),

	AREA(2, bitdw_area_2),
		WARP_NODE(0x11, LEVEL_BITDW, 0x02, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x12, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(241, LEVEL_CASTLE, 0x02, 0x5C, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 0x02, 0x5B, WARP_NO_CHECKPOINT),
		WARP_NODE(0x21, LEVEL_BOWSER_3, 0x01, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x1C, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x1B, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(255, 7164, 7860, 3192, 0, 0, 0, 0x10000, bhvGlowRot),
		OBJECT(252, -3964, -4268, 71, 0, 0, 0, 0x10000, bhvPlusRot),
		OBJECT(255, -4623, -3896, 71, 0, 0, 0, 0x10000, bhvGlowRot),
		OBJECT(255, 7164, 8032, 1948, 0, 0, 0, 0x10000, bhvGlowRot),
		OBJECT(255, -1055, 2979, -817, 0, 90, 0, 0x10000, bhvGlowRot),
		OBJECT(255, 3386, 3274, -4, 0, 90, 0, 0x10000, bhvGlowRot),
		OBJECT(0, 1052, 10482, 5, 0, 0, 0, 0x0, bhvBowserCourseRedCoinStar),
		OBJECT(223, 1128, 854, 9299, 0, 0, 0, 0x0, bhvChuckya),
		OBJECT(194, -482, 3325, 2943, 0, 0, 0, 0x0, bhvCirclingAmp),
		OBJECT(194, 969, 3325, 3290, 0, 0, 0, 0x0, bhvCirclingAmp),
		OBJECT(194, 1792, 2903, 4519, 0, 0, 0, 0x0, bhvCirclingAmp),
		OBJECT(194, 1861, 2497, 5552, 0, 0, 0, 0x0, bhvCirclingAmp),
		OBJECT(194, 856, 2013, 6835, 0, 0, 0, 0x0, bhvCirclingAmp),
		OBJECT(0, 9289, 8511, 21, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, 2474, -3643, 47, 0, 0, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -6015, -1919, -892, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(137, 2477, -3319, -13, 0, 0, 0, 0x70000, bhvExclamationBox),
		OBJECT(57, -4753, -752, 355, 0, 0, 0, 0x10000, bhvFerrisWheelAxle),
		OBJECT(57, 5345, 8032, -2, 0, 0, 0, 0x10000, bhvFerrisWheelAxle),
		OBJECT(57, -4618, -3424, 1254, 0, -180, 0, 0x10000, bhvFerrisWheelAxle),
		OBJECT(57, -1055, 2770, -4, 0, -90, 0, 0x10000, bhvFerrisWheelAxle),
		OBJECT(255, -1055, 2979, 1171, 0, 90, 0, 0x10000, bhvGlowRot),
		OBJECT(255, 5345, 9381, 1031, 0, 90, 0, 0x10000, bhvGlowRot),
		OBJECT(57, 10794, 8168, 304, 0, -180, 0, 0x10000, bhvFerrisWheelAxle),
		OBJECT(180, -7168, -1464, 314, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, 816, -4260, 322, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, 8596, 8945, 7, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, -1758, 1949, 7296, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, 4885, 5942, 0, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, 2265, -4308, -911, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(122, 1721, 3097, -773, 0, 0, 0, 0x0, bhvFlamethrower),
		OBJECT(122, -6217, 996, 3544, 0, 0, 0, 0x0, bhvFlamethrower),
		OBJECT(0, 3604, 9767, -2106, 0, 0, 0, 0x0, bhvFloorSwitchHiddenObjects),
		OBJECT(192, 2736, 10188, -36, 0, 0, 0, 0x0, bhvGoomba),
		OBJECT(192, 6282, 9017, 1678, 0, 0, 0, 0x0, bhvGoomba),
		OBJECT(192, -1743, -4537, -87, 0, 0, 0, 0x0, bhvGoomba),
		OBJECT(192, -102, 2067, 6963, 0, 0, 0, 0x0, bhvGoomba),
		OBJECT(192, -3590, -261, 1228, 0, 0, 0, 0x0, bhvGoomba),
		OBJECT(0, 5307, 5855, 10, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(129, 729, 9655, 1425, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, 1279, 9655, 1425, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, 1779, 9655, 1425, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, 2329, 9655, 1425, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, 2879, 9655, 1425, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(0, 6284, 6197, 0, 0, 0, 0, 0xCD0000, bhvPoleGrabbing),
		OBJECT(0, 1736, -4397, 4, 0, 0, 0, 0x6b0000, bhvPoleGrabbing),
		OBJECT(0, 3237, -4386, 1, 0, 0, 0, 0x9e0000, bhvPoleGrabbing),
		OBJECT(0, 5377, 7234, 3252, 0, 0, 0, 0xCD0000, bhvPoleGrabbing),
		OBJECT(215, 1780, 10037, 1425, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 5377, 7248, 3252, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 11915, 7729, 0, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 5837, 5740, -233, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 1045, 2436, -1956, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 1915, 1078, 8765, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -2211, -4060, -978, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 4432, -3541, -893, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(86, 1023, 2161, -1966, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, 7202, 8508, -55, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, 7096, 9588, 190, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, 6632, 9588, -312, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, -831, 3211, -2002, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, 2303, -3643, -34, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, 899, -4393, -95, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, 5319, 8387, 3819, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(86, -4500, -2713, 46, 0, 0, 0, 0x0, bhvSmallBully),
		OBJECT(0, 6636, -3855, 0, 0, -90, 0, 0x120000, bhvSpinAirborneWarp),
		OBJECT(0, 455, 10560, -15, 0, 90, 0, 0x1C0000, bhvAirborneDeathWarp),
		OBJECT(54, 5182, 9663, -307, 0, 0, 0, 0x0, bhvSquarishPathMoving),
		OBJECT(54, 5792, 9663, 303, 0, 0, 0, 0x20000, bhvSquarishPathMoving),
		OBJECT(54, 1419, 3243, -305, 0, 0, 0, 0x0, bhvSquarishPathMoving),
		OBJECT(54, 2029, 3243, 305, 0, 0, 0, 0x20000, bhvSquarishPathMoving),
		OBJECT(54, -4411, 70, 3089, 0, 0, 0, 0x0, bhvSquarishPathMoving),
		OBJECT(54, -3801, 70, 3699, 0, 0, 0, 0x20000, bhvSquarishPathMoving),
		OBJECT(54, -3332, 1272, 5979, 0, 0, 0, 0x0, bhvSquarishPathMoving),
		OBJECT(54, -2722, 1272, 6589, 0, 0, 0, 0x20000, bhvSquarishPathMoving),
		OBJECT(54, -4711, 1272, 4601, 0, 0, 0, 0x0, bhvSquarishPathMoving),
		OBJECT(54, -4101, 1272, 5211, 0, 0, 0, 0x20000, bhvSquarishPathMoving),
		OBJECT(248, 2, 10337, 4, 0, 0, 0, 0x210000, bhvWarpPipe),
		OBJECT(255, -15, 3099, -4, 0, 90, 0, 0x10000, bhvGlowRot),
		OBJECT(254, 7164, 8032, 1948, 7, -8, -45, 0x10000, bhvTorusRot),
		TERRAIN(bitdw_area_2_collision),
		MACRO_OBJECTS(bitdw_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x2D),
		TERRAIN_TYPE(TERRAIN_GRASS),
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
