#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

#include "make_const_nonconst.h"
#include "levels/hmc/header.h"

const LevelScript level_hmc_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _hmc_segment_7SegmentRomStart, _hmc_segment_7SegmentRomEnd), 
	LOAD_MIO0_TEXTURE(0x09, _cave_mio0SegmentRomStart, _cave_mio0SegmentRomEnd), 
	LOAD_MIO0(0x05, _group6_mio0SegmentRomStart, _group6_mio0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group6_geoSegmentRomStart, _group6_geoSegmentRomEnd), 
	LOAD_MIO0(0x06, _group17_mio0SegmentRomStart, _group17_mio0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group17_geoSegmentRomStart, _group17_geoSegmentRomEnd), 
	LOAD_MIO0(0x08, _common0_mio0SegmentRomStart, _common0_mio0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	LOAD_MIO0(0xa, _water_skybox_mio0SegmentRomStart, _water_skybox_mio0SegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_7), 
	JUMP_LINK(script_func_global_18), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_WOODEN_DOOR, wooden_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_DOOR, metal_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_HAZY_MAZE_DOOR, hazy_maze_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_PLATFORM, hmc_geo_0005A0), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_ARROW_PLATFORM, hmc_geo_0005B8), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ELEVATOR_PLATFORM, hmc_geo_0005D0), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ROLLING_ROCK, hmc_geo_000548), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ROCK_PIECE, hmc_geo_000570), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ROCK_SMALL_PIECE, hmc_geo_000588), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_RED_GRILLS, hmc_geo_000530), 
	LOAD_MODEL_FROM_GEO(24, spiky_tree_geo), 

	AREA(1, hmc_area_1),
		WARP_NODE(241, LEVEL_CASTLE, 2, 0x3C, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 2, 0x3B, WARP_NO_CHECKPOINT),
		WARP_NODE(0x11, LEVEL_HMC, 0x01, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x12, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x21, LEVEL_HMC, 0x02, 0x22, WARP_NO_CHECKPOINT),
		WARP_NODE(0x22, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(212, -8731, -5554, 15133, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(MODEL_NONE, -8620, -6870, 15128, 0, 0, 0, 0x00220000, bhvAirborneWarp),
		OBJECT(212, -8731, -5554, 15133, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(212, -3451, -4811, 11971, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(188, 3752, -7157, 15956, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, 3163, -7053, 12924, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -87, -7022, 11623, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -237, -7157, 6660, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -2425, -3938, 8853, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, 3955, -5432, 4826, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, 3442, -5432, 9501, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, 8709, -5530, 7052, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -1723, -7415, 16244, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, 1203, -2265, 14637, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -6594, -7388, 15318, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -4423, -7152, 10692, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(255, 4952, -6585, 14297, 0, 0, 0, 0x0, bhvGlowRot),
		OBJECT(255, 5884, -6177, 14434, 0, 0, 0, 0x0, bhvGlowRot),
		OBJECT(129, -1220, -7155, 10320, 0, 0, 0, 0x0, bhvBreakableBox),
		OBJECT(129, -884, -7155, 9987, 0, 0, 0, 0x10000, bhvBreakableBox),
		OBJECT(0, -4236, -7415, 15923, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -4236, -7909, 15927, 0, 0, 0, 0x100000, bhvCoinFormation),
		OBJECT(0, 2149, -6989, 11854, 0, 43, 0, 0x0, bhvCoinFormation),
		OBJECT(0, 6944, -5689, 12325, 0, -34, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -3442, -5730, 11584, 0, 0, 0, 0x110000, bhvCoinFormation),
		OBJECT(137, 6301, -6900, 10650, 0, -7, 0, 0x30000, bhvExclamationBox),
		OBJECT(137, -266, -6963, 16602, 0, 0, 0, 0x30000, bhvExclamationBox),
		OBJECT(137, 5078, -4492, 10895, 0, 0, 0, 0x00000, bhvExclamationBox),
		OBJECT(180, -1234, -5542, 8874, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, -1665, -5463, 11573, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, -2427, -6004, 6302, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(192, -5874, -7169, 19923, 0, 0, 0, 0x10000, bhvGoomba),
		OBJECT(0, 8778, -5432, 9004, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(0, 5719, -5561, 9605, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(0, -3894, -7099, 6434, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(0, 5362, -6906, 17809, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(0, 893, -7361, 18181, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(0, -7014, -7388, 17168, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT_WITH_ACTS(124, -1366, -7157, 10155, 0, 90, 0, 0x00200000, bhvMessagePanel, ACT_1 | ACT_2 | ACT_3 | ACT_4 | ACT_5),
		OBJECT(124, 3513, -7075, 17071, 0, 32, 0, 0x210000, bhvMessagePanel),
		OBJECT(124, 6372, -7131, 10264, 0, -9, 0, 0x001E0000, bhvMessagePanel),
		OBJECT(0, 3759, -6740, 17475, 0, -180, 0, 0x120000, bhvSpinAirborneWarp),
		OBJECT(251, 955, -2420, 4609, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 6902, -4439, 11692, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 1095, -3511, 11381, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -1900, -4833, 11548, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -813, -5275, 18801, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 3627, -4254, 17526, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -5831, -5585, 11809, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -3377, -5217, 6237, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -1033, -6330, 6599, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -4257, -3099, 6117, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 6056, -3016, 8686, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 581, -1199, 10645, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -2116, -3786, 11957, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 1691, -4651, 18226, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 5292, -2653, 15333, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -5641, -5257, 13718, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -5533, -4538, 7631, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -5286, -6715, 8941, 0, 43, 0, 0x0, bhvSpikeRot),
		OBJECT(122, -2434, -3567, 8865, 0, 0, 0, 1, bhvStar),
		OBJECT(250, 4251, -2517, 6397, 0, 90, 0, 0x051D0000, bhvDorriePanel),
		OBJECT(MODEL_NONE, -8871, -7008, 15128, 0, 0, 0, 0x00210000, bhvFadingWarp),
		OBJECT(MODEL_STAR, -6516, -1464, 19366, 0, 0, 0, 0x01000001, bhvStar),
		TERRAIN(hmc_area_1_collision),
		MACRO_OBJECTS(hmc_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x2A),
		TERRAIN_TYPE(TERRAIN_GRASS),
	END_AREA(),

	AREA(2, hmc_area_2),
		WARP_NODE(241, LEVEL_CASTLE_GROUNDS, 1, 71, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE_GROUNDS, 1, 70, WARP_NO_CHECKPOINT),
		WARP_NODE(0x11, LEVEL_HMC, 0x02, 0x12, WARP_NO_CHECKPOINT),
		WARP_NODE(0x12, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x21, LEVEL_HMC, 0x01, 0x22, WARP_NO_CHECKPOINT),
		WARP_NODE(0x22, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(212, 1239, -5945, 1282, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(212, 1239, -5945, 1282, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(212, 2341, -8028, 1440, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(212, 843, -6830, -1559, 0, 0, 0, 0x0, bhv1Up),
		OBJECT(188, -5282, -8133, -3674, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(188, -4895, -8080, -3232, 0, 0, 0, 0x0, bhvBobomb),
		OBJECT(0, -2142, -8093, -2398, 0, -116, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -2671, -5372, -4100, 90, 0, 0, 0x130000, bhvCoinFormation),
		OBJECT(0, 1633, -7560, -2138, 0, 0, 0, 0x110000, bhvCoinFormation),
		OBJECT(0, 2029, -6570, -2172, 0, 0, 0, 0x110000, bhvCoinFormation),
		OBJECT(0, 1805, -5424, -346, 90, 0, 90, 0x130000, bhvCoinFormation),
		OBJECT(0, -225, -8680, -3936, 0, 0, 45, 0x110000, bhvCoinFormation),
		OBJECT(0, -1255, -3858, 1033, 0, 0, 0, 0x110000, bhvCoinFormation),
		OBJECT(0, -4867, -8143, -1162, 0, 0, 0, 0x110000, bhvCoinFormation),
		OBJECT(0, -3636, -8209, -454, -90, 0, -90, 0x130000, bhvCoinFormation),
		OBJECT(0, 1286, -8814, -6464, -90, 0, -90, 0x130000, bhvCoinFormation),
		OBJECT(0, -3577, -6805, 96, -90, 0, -90, 0x130000, bhvCoinFormation),
		OBJECT(137, 2070, -7947, -5329, 0, 0, 0, 0x30000, bhvExclamationBox),
		OBJECT(137, 2589, -5632, 194, 0, 0, 0, 0x60000, bhvExclamationBox),
		OBJECT(137, 665, -5632, 310, 0, 0, 0, 0x60000, bhvExclamationBox),
		OBJECT(180, -5764, -6960, -2673, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(180, -5028, -8120, -1790, 0, 0, 0, 0x0, bhvFireSpitter),
		OBJECT(192, -282, -8028, -1174, -1, 0, 0, 0x0, bhvGoomba),
		OBJECT(192, -899, -8028, -1223, 0, 0, 0, 0x0, bhvGoomba),
		OBJECT(0, -2281, -8209, -7092, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(0, -1612, -8209, -6288, 0, 0, 0, 0x0, bhvGoombaTripletSpawner),
		OBJECT(124, -1675, -5033, 956, 0, -89, 0, 0x001F0000, bhvMessagePanel),
		OBJECT(124, 1941, -8209, -2415, 0, -94, 0, 0x220000, bhvMessagePanel),
		OBJECT(120, -5004, -6390, -1199, 0, 0, 0, 0x0, bhvRecoveryHeart),
		OBJECT(120, -2192, -5070, 587, 0, 0, 0, 0x0, bhvRecoveryHeart),
		OBJECT(215, 1237, -8133, -970, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 1668, -7039, 876, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 806, -6830, -2131, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 3073, -8028, 264, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 1752, -5737, 815, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 1060, -8769, -5258, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -2472, -8143, -1103, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -3083, -7429, 388, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(0, -4968, -7929, -6561, 0, 0, 0, 0x220000, bhvSpinAirborneWarp),
		OBJECT(24, -2103, -8209, -5574, 0, 0, 0, 0x0, bhvTree),
		OBJECT(24, -1076, -8209, -6823, 0, 0, 0, 0x0, bhvTree),
		OBJECT(24, 2316, -8209, -7181, 0, 0, 0, 0x0, bhvTree),
		OBJECT(252, -4305, -7724, -3193, 0, 0, 0, 0x0, bhvPlusRot),
		OBJECT(255, -5017, -7450, -3079, 0, 16, 0, 0x0, bhvGlowRot),
		OBJECT(251, -3640, -7283, -6338, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 1826, -6950, -4833, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -2771, -6950, -2738, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 29, -7569, -2726, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -399, -6157, 1429, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -3269, -6330, -210, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -3297, -7713, -415, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -834, -5512, -4580, 0, 0, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -5441, -6728, -5779, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 212, -6239, -6215, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -3405, -6239, -2686, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -765, -7148, -3624, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, 239, -5073, 431, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -3016, -5328, -139, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -4930, -7361, -322, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(251, -2206, -4125, -5076, 0, 20, 0, 0x0, bhvSpikeRot),
		OBJECT(MODEL_STAR, 1516, -4212, -5694, 0, 0, 0, 0x02000001, bhvStar),
		OBJECT(MODEL_STAR, -1807, -6760, 1176, 0, -31, 0, 0x03000001, bhvStar),
		OBJECT(0, -4692, -7653, 988, 0, 0, 0, 0x4000001, bhvHiddenRedCoinStar),
		OBJECT(0, -4953, -8189, -6876, 0, 0, 0, 0x210000, bhvFadingWarp),
		OBJECT(MODEL_EXCLAMATION_BOX, -5004, -6268, -1445, 0, 0, 0, 0x0, bhvExclamationBox),
		OBJECT(MODEL_EXCLAMATION_BOX, -2679, -5029, -4108, 0, 0, 0, 0x0, bhvExclamationBox),
		TERRAIN(hmc_area_2_collision),
		MACRO_OBJECTS(hmc_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x2A),
		TERRAIN_TYPE(TERRAIN_GRASS),
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
